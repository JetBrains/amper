{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "CommonDeftSchema.json",
  "title": "Common Deft DSL",
  "type": "object",
  "$defs": {
    "DeftSchema": {
      "properties": {
        "aliases": {
          "type": "object",
          "patternProperties": {
            "^[^@+:]+$": {
              "$ref": "#/$defs/platformList"
            }
          }
        },
        "variants": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          }
        },
        "dependencies": {
          "$ref": "#/$defs/dependencyList"
        },
        "dependencies@jvm": {
          "$ref": "#/$defs/dependencyList"
        },
        "dependencies@android": {
          "$ref": "#/$defs/androidDependencyList"
        },
        "dependencies@ios": {
          "$ref": "#/$defs/dependencyList"
        },
        "test-dependencies": {
          "$ref": "#/$defs/testDependencyList"
        },
        "test-dependencies@jvm": {
          "$ref": "#/$defs/testDependencyList"
        },
        "test-dependencies@android": {
          "$ref": "#/$defs/testAndroidDependencyList"
        },
        "test-dependencies@ios": {
          "$ref": "#/$defs/testDependencyList"
        },
        "settings": {
          "$ref": "#/$defs/settings"
        },
        "settings@jvm": {
          "$ref": "#/$defs/settings"
        },
        "settings@android": {
          "$ref": "#/$defs/settings"
        },
        "settings@ios": {
          "$ref": "#/$defs/settings"
        },
        "test-settings": {
          "$ref": "#/$defs/settings"
        },
        "test-settings@jvm": {
          "$ref": "#/$defs/settings"
        },
        "test-settings@android": {
          "$ref": "#/$defs/settings"
        },
        "test-settings@ios": {
          "$ref": "#/$defs/settings"
        },
        "repositories": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/repository"
          }
        }
      },
      "patternProperties": {
        "^dependencies(@.+)?$": {
          "$ref": "#/$defs/dependencyList"
        },
        "^test-dependencies(@.+)?$": {
          "$ref": "#/$defs/testDependencyList"
        },
        "^(test-)?settings(@.+)?$": {
          "$ref": "#/$defs/settings"
        }
      },
      "additionalProperties": false
    },
    "platform": {
      "enum": [
        "jvm",
        "android",
        "linuxX64",
        "linuxArm64",
        "macosX64",
        "macosArm64",
        "iosArm64",
        "iosX64",
        "iosSimulatorArm64"
      ]
    },
    "platformList": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "$ref": "#/$defs/platform"
      }
    },
    "dependency": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "$ref": "#/$defs/jetpackComposeDependency"
        },
        {
          "$ref": "#/$defs/ktorDependency"
        }
      ]
    },
    "testDependency": {
      "anyOf": [
        {
          "$ref": "#/$defs/dependency"
        },
        {
          "enum": [
            "org.jetbrains.kotlin:kotlin-test:1.8.20",
            "org.jetbrains.kotlin:kotlin-test:1.9.0",
            "junit:junit:4.13.2",
            "org.junit.jupiter:junit-jupiter-api:5.9.3",
            "org.junit.jupiter:junit-jupiter-engine:5.9.3",
            "org.junit.vintage:junit-vintage-engine:5.9.3"
          ]
        },
        {
          "$ref": "#/$defs/jetpackComposeTestDependency"
        },
        {
          "$ref": "#/$defs/ktorTestDependency"
        }
      ]
    },
    "dependencyList": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "$ref": "#/$defs/dependency"
      }
    },
    "testDependencyList": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "$ref": "#/$defs/testDependency"
      }
    },
    "androidDependencyList": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "anyOf": [
          {
            "$ref": "#/$defs/dependency"
          },
          {
            "$ref": "#/$defs/androidDependency"
          }
        ]
      }
    },
    "testAndroidDependencyList": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "anyOf": [
          {
            "$ref": "#/$defs/testDependency"
          },
          {
            "$ref": "#/$defs/androidTestDependency"
          }
        ]
      }
    },
    "settings": {
      "type": "object",
      "properties": {
        "kotlin": {
          "$ref": "#/$defs/kotlinSettings"
        },
        "java": {
          "$ref": "#/$defs/javaSettings"
        },
        "android": {
          "$ref": "#/$defs/androidSettings"
        },
        "publishing": {
          "$ref": "#/$defs/publishingSettings"
        },
        "junit": {
          "$ref": "#/$defs/junitSettings"
        },
        "compose": {
          "$ref": "#/$defs/composeSettings"
        }
      },
      "additionalProperties": false
    },
    "javaSettings": {
      "type": "object",
      "properties": {
        "mainClass": {
          "type": "string"
        },
        "packagePrefix": {
          "type": "string"
        },
        "target": {
          "$ref": "#/$defs/kotlinJvmVersion"
        },
        "source": {
          "$ref": "#/$defs/kotlinJvmVersion"
        }
      },
      "additionalProperties": false
    },
    "javaVersion": {
      "$comment": "This version is mapped to org.gradle.api.JavaVersion",
      "$comment": "Not using 'integer' with range for proper completion in IntelliJ",
      "enum": [
        1.1,
        1.2,
        1.3,
        1.4,
        1.5,
        1.6,
        1.7,
        1.8,
        1.9,
        1.10,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24
      ]
    },
    "kotlinJvmVersion": {
      "$comment": "This version is mapped to org.jetbrains.kotlin.gradle.dsl.JvmTarget, so it contains only JVM version compatible with Kotlin compiler",
      "$comment": "Not using 'integer' with range for proper completion in IntelliJ",
      "enum": [
        1.8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19
      ]
    },
    "kotlinSettings": {
      "type": "object",
      "properties": {
        "languageVersion": {
          "$ref": "#/$defs/kotlinVersion"
        },
        "apiVersion": {
          "$ref": "#/$defs/kotlinVersion"
        },
        "allWarningsAsError": {
          "type": "boolean"
        },
        "suppressWarnings": {
          "type": "boolean"
        },
        "verbose": {
          "type": "boolean"
        },
        "debug": {
          "type": "boolean"
        },
        "progressiveMode": {
          "type": "boolean"
        },
        "languageFeatures": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/kotlinLanguageFeature"
          }
        },
        "optIns": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "freeCompilerArgs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "kotlinVersion": {
      "enum": [
        1.0,
        1.1,
        1.2,
        1.3,
        1.4,
        1.5,
        1.6,
        1.7,
        1.8,
        1.9,
        2.0
      ]
    },
    "kotlinLanguageFeature": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "enum": [
            "contextReceivers"
          ]
        }
      ]
    },
    "androidSettings": {
      "type": "object",
      "properties": {
        "compileSdkVersion": {
          "$ref": "#/$defs/androidApiVersion"
        },
        "minSdk": {
          "$ref": "#/$defs/androidSdkVersion"
        },
        "minSdkPreview": {
          "$ref": "#/$defs/androidSdkVersion"
        },
        "maxSdk": {
          "$ref": "#/$defs/androidSdkIntegerVersion"
        },
        "targetSdk": {
          "$ref": "#/$defs/androidSdkVersion"
        },
        "applicationId": {
          "type": "string"
        },
        "namespace": {
          "type": "string"
        }
      },
      "anyOf": [
        {
          "oneOf": [
            {
              "required": [
                "minSdk"
              ]
            },
            {
              "required": [
                "minSdkPreview"
              ]
            }
          ]
        },
        {
          "not": {
            "required": [
              "minSdk",
              "minSdkPreview"
            ]
          }
        }
      ],
      "additionalProperties": false
    },
    "androidApiVersion": {
      "$comment": "Patterns are taken from com.android.build.gradle.internal.utils.SdkUtils",
      "anyOf": [
        {
          "typeOf": "string",
          "pattern": "^android-([0-9]+)(-ext(\\d+))?$"
        },
        {
          "typeOf": "string",
          "pattern": "^android-([A-Z][0-9A-Za-z_]*)$"
        },
        {
          "typeOf": "string",
          "pattern": "^(.+):(.+):(\\d+)$"
        },
        {
          "enum": [
            "android-34",
            "android-33",
            "android-32",
            "android-31",
            "android-30",
            "android-29",
            "android-28",
            "android-27",
            "android-26"
          ]
        }
      ]
    },
    "androidSdkIntegerVersion": {
      "anyOf": [
        {
          "type": "integer",
          "minimum": 1
        },
        {
          "enum": [
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33,
            34
          ]
        }
      ]
    },
    "androidSdkVersion": {
      "anyOf": [
        {
          "$ref": "#/$defs/androidSdkIntegerVersion"
        },
        {
          "enum": [
            "UPSIDE_DOWN_CAKE",
            "TIRAMISU",
            "S_V2",
            "S",
            "R",
            "Q",
            "P",
            "O_MR1",
            "O",
            "N_MR1",
            "N",
            "M",
            "LOLLIPOP_MR1",
            "LOLLIPOP",
            "KITKAT_WATCH",
            "KITKAT",
            "JELLY_BEAN_MR2",
            "JELLY_BEAN_MR1",
            "JELLY_BEAN",
            "ICE_CREAM_SANDWICH_MR1",
            "ICE_CREAM_SANDWICH",
            "HONEYCOMB_MR2",
            "HONEYCOMB_MR1",
            "HONEYCOMB",
            "GINGERBREAD_MR1",
            "GINGERBREAD",
            "FROYO",
            "ECLAIR_MR1",
            "ECLAIR_0_1",
            "ECLAIR",
            "DONUT",
            "CUPCAKE",
            "BASE_1_1",
            "BASE"
          ]
        },
        {
          "type": "string"
        }
      ]
    },
    "publishingSettings": {
      "type": "object",
      "properties": {
        "group": {
          "type": "string"
        },
        "version": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "junitSettings": {
      "type": "object",
      "properties": {
        "platformEnabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "composeSettings": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "jetpackComposeDependency": {
      "enum": [
        "org.jetbrains.compose.animation:animation:1.4.1",
        "org.jetbrains.compose.animation:animation-graphics:1.4.1",
        "org.jetbrains.compose.foundation:foundation:1.4.1",
        "org.jetbrains.compose.material:material:1.4.1",
        "org.jetbrains.compose.material3:material3:1.4.1",
        "org.jetbrains.compose.ui:ui:1.4.1",
        "org.jetbrains.compose.runtime:runtime:1.4.1",
        "org.jetbrains.compose.ui:ui-tooling:1.4.1",
        "org.jetbrains.compose.ui:ui-tooling-preview:1.4.1",

        "org.jetbrains.compose.desktop:desktop-jvm-macos-arm64:1.4.1",
        "org.jetbrains.compose.desktop:desktop-jvm-macos-x64:1.4.1",
        "org.jetbrains.compose.desktop:desktop-jvm-windows-x64:1.4.1",
        "org.jetbrains.compose.desktop:desktop-jvm-linux-x64:1.4.1"
      ]
    },
    "jetpackComposeTestDependency": {
      "enum": [
        "org.jetbrains.compose.ui:ui-test:1.4.1",
        "org.jetbrains.compose.ui:ui-test-junit4:1.4.1"
      ]
    },
    "androidDependency": {
      "$comment": "Versions from Compose BOM at https://developer.android.com/jetpack/compose/bom/bom-mapping",
      "enum": [
        "androidx.core:core-ktx:1.10.1",
        "androidx.appcompat:appcompat:1.6.1",
        "androidx.activity:activity-compose:1.7.2",
        "androidx.lifecycle:lifecycle-viewmodel-compose:2.6.1",
        "androidx.compose.animation:animation:1.4.3",
        "androidx.compose.animation:animation-core:1.4.3",
        "androidx.compose.animation:animation-graphics:1.4.3",
        "androidx.compose.foundation:foundation:1.4.3",
        "androidx.compose.material:material:1.4.3",
        "androidx.compose.material3:material3:1.1.1",
        "androidx.compose.ui:ui:1.4.3",
        "androidx.compose.runtime:runtime:1.4.3",
        "androidx.compose.runtime:runtime-livedata:1.4.3",
        "androidx.compose.runtime:runtime-rxjava2:1.4.3",
        "androidx.compose.runtime:runtime-rxjava3:1.4.3",
        "androidx.compose.runtime:runtime-saveable:1.4.3",
        "androidx.compose.ui:ui-geometry:1.4.3",
        "androidx.compose.ui:ui-graphics:1.4.3",
        "androidx.compose.ui:ui-text:1.4.3",
        "androidx.compose.ui:ui-tooling:1.4.3",
        "androidx.compose.ui:ui-tooling-data:1.4.3",
        "androidx.compose.ui:ui-tooling-preview:1.4.3",
        "androidx.compose.ui:ui-unit:1.4.3",
        "androidx.compose.ui:ui-util:1.4.3",
        "androidx.compose.ui:ui-viewbinding:1.4.3"
      ]
    },
    "androidTestDependency": {
      "$comment": "Versions from Compose BOM at https://developer.android.com/jetpack/compose/bom/bom-mapping",
      "enum": [
        "androidx.compose.ui:ui-test:1.4.3",
        "androidx.compose.ui:ui-test-junit4:1.4.3",
        "androidx.compose.ui:ui-test-manifest:1.4.3"
      ]
    },
    "ktorDependency": {
      "enum": [
        "io.ktor:ktor-server-auth:2.3.2",
        "io.ktor:ktor-server-core:2.3.2",
        "io.ktor:ktor-server-content-negotiation:2.3.2",
        "io.ktor:ktor-server-html-builder:2.3.2",
        "io.ktor:ktor-server-locations:2.3.2",
        "io.ktor:ktor-server-netty:2.3.2",
        "io.ktor:ktor-server-resources:2.3.2",
        "io.ktor:ktor-server-sessions:2.3.2",
        "io.ktor:ktor-server-websockets:2.3.2",
        "io.ktor:ktor-client-auth:2.3.2",
        "io.ktor:ktor-client-cio:2.3.2",
        "io.ktor:ktor-client-content-negotiation:2.3.2",
        "io.ktor:ktor-client-core:2.3.2",
        "io.ktor:ktor-client-encoding:2.3.2",
        "io.ktor:ktor-client-logging:2.3.2",
        "io.ktor:ktor-client-resources:2.3.2",
        "io.ktor:ktor-client-websockets:2.3.2"
      ]
    },
    "ktorTestDependency": {
      "enum": [
        "io.ktor:ktor-server-test-host:2.3.2",
        "io.ktor:ktor-client-mock:2.3.2"
      ]
    },
    "repository": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "url": {
              "type": "string"
            },
            "username": {
              "type": "string"
            },
            "password": {
              "type": "string"
            },
            "publish": {
              "type": "boolean"
            }
          },
          "additionalProperties": false,
          "required": [
            "id",
            "url"
          ]
        },
        {
          "type": "string"
        }
      ]
    }
  }
}
