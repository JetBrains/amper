I think we might want to place some semantic invariants checking here.

At least, I (@aleksandr.tsarev) want to move some of them from backend.