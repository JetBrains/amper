{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "Deft DSL schema (Fragments)",
  "title": "Deft DSL with Fragments",
  "type": "object",
  "properties": {
    "type": {
      "type": "string",
      "enum": [
        "app",
        "lib"
      ]
    },
    "platforms": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "jvm",
          "android",
          "iosArm64",
          "iosX64",
          "iosSimulatorArm64"
        ]
      }
    },
    "variants": {
      "type": "array",
      "items": {
        "type": "array",
        "items": {
          "type": "string"
        }
      }
    },
    "fragments": {
      "type": "object",
      "properties": {
        "common": {
          "$ref": "#/$defs/fragment"
        },
        "commonTest": {
          "$ref": "#/$defs/fragment"
        },
        "jvm": {
          "$ref": "#/$defs/fragment"
        },
        "jvmTest": {
          "$ref": "#/$defs/fragment"
        },
        "wasm": {
          "$ref": "#/$defs/fragment"
        },
        "wasmTest": {
          "$ref": "#/$defs/fragment"
        },
        "ios": {
          "$ref": "#/$defs/fragment"
        },
        "iosTest": {
          "$ref": "#/$defs/fragment"
        },
        "js": {
          "$ref": "#/$defs/fragment"
        },
        "jsTest": {
          "$ref": "#/$defs/fragment"
        },
        "native": {
          "$ref": "#/$defs/fragment"
        },
        "nativeTest": {
          "$ref": "#/$defs/fragment"
        },
        "android": {
          "$ref": "#/$defs/fragment"
        },
        "androidTest": {
          "$ref": "#/$defs/fragment"
        },
        "iosArm64": {
          "$ref": "#/$defs/fragment"
        },
        "iosArm64Test": {
          "$ref": "#/$defs/fragment"
        },
        "iosSimulatorArm64": {
          "$ref": "#/$defs/fragment"
        },
        "iosSimulatorArm64Test": {
          "$ref": "#/$defs/fragment"
        },
        "iosX64": {
          "$ref": "#/$defs/fragment"
        },
        "iosX64Test": {
          "$ref": "#/$defs/fragment"
        },
        "linux": {
          "$ref": "#/$defs/fragment"
        },
        "linuxTest": {
          "$ref": "#/$defs/fragment"
        },
        "linuxArm64": {
          "$ref": "#/$defs/fragment"
        },
        "linuxArm64Test": {
          "$ref": "#/$defs/fragment"
        },
        "linuxX64": {
          "$ref": "#/$defs/fragment"
        },
        "linuxX64Test": {
          "$ref": "#/$defs/fragment"
        },
        "apple": {
          "$ref": "#/$defs/fragment"
        },
        "appleTest": {
          "$ref": "#/$defs/fragment"
        },
        "mingw": {
          "$ref": "#/$defs/fragment"
        },
        "mingwTest": {
          "$ref": "#/$defs/fragment"
        },
        "mingwX64": {
          "$ref": "#/$defs/fragment"
        },
        "mingwX64Test": {
          "$ref": "#/$defs/fragment"
        }
      },
      "patternProperties": {
        "^.+$": {
          "$ref": "#/$defs/fragment"
        }
      },
      "additionalProperties": false
    }
  },
  "required": [
    "type",
    "platforms"
  ],
  "$defs": {
    "fragment": {
      "$dynamicAnchor": "Fragment",
      "type": "object",
      "properties": {
        "refines": {
          "oneOf": [
            {
              "$ref": "#/$defs/refine"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/refine"
              }
            }
          ]
        },
        "dependencies": {
          "type": "array"
        },
        "kotlin": {
          "type": "object",
          "properties": {
            "languageVersion": {
              "type": ["number", "string"]
            },
            "apiVersion": {
              "type": ["number", "string"]
            },
            "progressiveMode": {
              "type": "boolean"
            },
            "languageFeatures": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "optIns": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "entryPoint": {
          "type": "string"
        },
        "mainClass": {
          "type": "string"
        }
      }
    },
    "refine": {
      "type": "string"
    }
  }
}